# # predicted
pdf("my_plot.pdf", width=324/300, height=432/300,)
mapmisc::map.new(UK2)
plot(UK2,col=pCol$plot,add =TRUE,lwd =0.2)
mapmisc::legendBreaks("left", pCol,bty ="n")
# casesCol=mapmisc::colourScale(UK2$cases,dec =-3,breaks =12,col ="Spectral",style="quantile",rev=TRUE)
# Ecol=mapmisc::colourScale(UK2$E,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
# pmCol=mapmisc::colourScale(UK2$modelledpm25,breaks =9,dec =0,style ="quantile")
# ethCol=mapmisc::colourScale(UK2$Ethnicity,breaks =9,digits =1,style ="quantile")
# uCol=mapmisc::colourScale(UK2$Unemployment,breaks =12,dec =0,style ="quantile")
# rCol=mapmisc::colourScale(englandRes$data$random.mean,breaks =12,dec =-log10(0.25),style ="quantile")
# fCol=mapmisc::colourScale(englandRes$data$fitted.exp,breaks =9,dec =1,style ="quantile")
# insetEngland1=mapmisc::openmap(UK2,zoom =3,fact =4,path ="waze",crs =CRS("+init=epsg:3035"))
# pCol=mapmisc::colourScale(UK2$E*englandRes$data$fitted.exp,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
#
# library("raster")
# insetEngland=raster::crop(insetEngland1,extend(extent(insetEngland1),-c(25,7,4,9.5)*100*1000))
# #
# # mapmisc::map.new(UK2)
# # mapmisc::insetMap(UK_shp,"topright", insetEngland,width =0.4)
# # plot(UK2,col =casesCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =Ecol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =pmCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", pmCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =ethCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", ethCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =uCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", uCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =rCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", rCol,bty ="n")
# mapmisc::map.new(UK2)
# plot(UK2,col =fCol$plot,add =TRUE,lwd =0.2)
# mapmisc::legendBreaks("left", fCol,bty ="n")
#
# # predicted
pdf("my_plot.pdf", width=324/300, height=432/300,)
# casesCol=mapmisc::colourScale(UK2$cases,dec =-3,breaks =12,col ="Spectral",style="quantile",rev=TRUE)
# Ecol=mapmisc::colourScale(UK2$E,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
# pmCol=mapmisc::colourScale(UK2$modelledpm25,breaks =9,dec =0,style ="quantile")
# ethCol=mapmisc::colourScale(UK2$Ethnicity,breaks =9,digits =1,style ="quantile")
# uCol=mapmisc::colourScale(UK2$Unemployment,breaks =12,dec =0,style ="quantile")
# rCol=mapmisc::colourScale(englandRes$data$random.mean,breaks =12,dec =-log10(0.25),style ="quantile")
# fCol=mapmisc::colourScale(englandRes$data$fitted.exp,breaks =9,dec =1,style ="quantile")
# insetEngland1=mapmisc::openmap(UK2,zoom =3,fact =4,path ="waze",crs =CRS("+init=epsg:3035"))
# pCol=mapmisc::colourScale(UK2$E*englandRes$data$fitted.exp,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
#
# library("raster")
# insetEngland=raster::crop(insetEngland1,extend(extent(insetEngland1),-c(25,7,4,9.5)*100*1000))
# #
# # mapmisc::map.new(UK2)
# # mapmisc::insetMap(UK_shp,"topright", insetEngland,width =0.4)
# # plot(UK2,col =casesCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =Ecol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =pmCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", pmCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =ethCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", ethCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =uCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", uCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =rCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", rCol,bty ="n")
# mapmisc::map.new(UK2)
# plot(UK2,col =fCol$plot,add =TRUE,lwd =0.2)
# mapmisc::legendBreaks("left", fCol,bty ="n")
#
# # predicted
pdf("my_plot.pdf", width=324/300, height=432/300,)
mapmisc::map.new(UK2)
plot(UK2,col=pCol$plot,add =TRUE,lwd =0.2)
mapmisc::legendBreaks("left", pCol,bty ="n")
dev.off
# casesCol=mapmisc::colourScale(UK2$cases,dec =-3,breaks =12,col ="Spectral",style="quantile",rev=TRUE)
# Ecol=mapmisc::colourScale(UK2$E,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
# pmCol=mapmisc::colourScale(UK2$modelledpm25,breaks =9,dec =0,style ="quantile")
# ethCol=mapmisc::colourScale(UK2$Ethnicity,breaks =9,digits =1,style ="quantile")
# uCol=mapmisc::colourScale(UK2$Unemployment,breaks =12,dec =0,style ="quantile")
# rCol=mapmisc::colourScale(englandRes$data$random.mean,breaks =12,dec =-log10(0.25),style ="quantile")
# fCol=mapmisc::colourScale(englandRes$data$fitted.exp,breaks =9,dec =1,style ="quantile")
# insetEngland1=mapmisc::openmap(UK2,zoom =3,fact =4,path ="waze",crs =CRS("+init=epsg:3035"))
# pCol=mapmisc::colourScale(UK2$E*englandRes$data$fitted.exp,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
#
# library("raster")
# insetEngland=raster::crop(insetEngland1,extend(extent(insetEngland1),-c(25,7,4,9.5)*100*1000))
# #
# # mapmisc::map.new(UK2)
# # mapmisc::insetMap(UK_shp,"topright", insetEngland,width =0.4)
# # plot(UK2,col =casesCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =Ecol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =pmCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", pmCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =ethCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", ethCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =uCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", uCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =rCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", rCol,bty ="n")
# mapmisc::map.new(UK2)
# plot(UK2,col =fCol$plot,add =TRUE,lwd =0.2)
# mapmisc::legendBreaks("left", fCol,bty ="n")
#
# # predicted
pdf("my_plot.pdf", width=324/300, height=432/300,)
# casesCol=mapmisc::colourScale(UK2$cases,dec =-3,breaks =12,col ="Spectral",style="quantile",rev=TRUE)
# Ecol=mapmisc::colourScale(UK2$E,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
# pmCol=mapmisc::colourScale(UK2$modelledpm25,breaks =9,dec =0,style ="quantile")
# ethCol=mapmisc::colourScale(UK2$Ethnicity,breaks =9,digits =1,style ="quantile")
# uCol=mapmisc::colourScale(UK2$Unemployment,breaks =12,dec =0,style ="quantile")
# rCol=mapmisc::colourScale(englandRes$data$random.mean,breaks =12,dec =-log10(0.25),style ="quantile")
# fCol=mapmisc::colourScale(englandRes$data$fitted.exp,breaks =9,dec =1,style ="quantile")
# insetEngland1=mapmisc::openmap(UK2,zoom =3,fact =4,path ="waze",crs =CRS("+init=epsg:3035"))
# pCol=mapmisc::colourScale(UK2$E*englandRes$data$fitted.exp,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
#
# library("raster")
# insetEngland=raster::crop(insetEngland1,extend(extent(insetEngland1),-c(25,7,4,9.5)*100*1000))
# #
# # mapmisc::map.new(UK2)
# # mapmisc::insetMap(UK_shp,"topright", insetEngland,width =0.4)
# # plot(UK2,col =casesCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =Ecol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =pmCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", pmCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =ethCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", ethCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =uCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", uCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =rCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", rCol,bty ="n")
# mapmisc::map.new(UK2)
# plot(UK2,col =fCol$plot,add =TRUE,lwd =0.2)
# mapmisc::legendBreaks("left", fCol,bty ="n")
#
# # predicted
pdf("my_plot.pdf", width=324/300, height=432/300,)
mapmisc::map.new(UK2)
plot(UK2,col=pCol$plot,add =TRUE,lwd =0.2)
mapmisc::legendBreaks("left", pCol,bty ="n",adj = TRUE)
dev.off
# casesCol=mapmisc::colourScale(UK2$cases,dec =-3,breaks =12,col ="Spectral",style="quantile",rev=TRUE)
# Ecol=mapmisc::colourScale(UK2$E,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
# pmCol=mapmisc::colourScale(UK2$modelledpm25,breaks =9,dec =0,style ="quantile")
# ethCol=mapmisc::colourScale(UK2$Ethnicity,breaks =9,digits =1,style ="quantile")
# uCol=mapmisc::colourScale(UK2$Unemployment,breaks =12,dec =0,style ="quantile")
# rCol=mapmisc::colourScale(englandRes$data$random.mean,breaks =12,dec =-log10(0.25),style ="quantile")
# fCol=mapmisc::colourScale(englandRes$data$fitted.exp,breaks =9,dec =1,style ="quantile")
# insetEngland1=mapmisc::openmap(UK2,zoom =3,fact =4,path ="waze",crs =CRS("+init=epsg:3035"))
# pCol=mapmisc::colourScale(UK2$E*englandRes$data$fitted.exp,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
#
# library("raster")
# insetEngland=raster::crop(insetEngland1,extend(extent(insetEngland1),-c(25,7,4,9.5)*100*1000))
# #
# # mapmisc::map.new(UK2)
# # mapmisc::insetMap(UK_shp,"topright", insetEngland,width =0.4)
# # plot(UK2,col =casesCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =Ecol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =pmCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", pmCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =ethCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", ethCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =uCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", uCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =rCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", rCol,bty ="n")
# mapmisc::map.new(UK2)
# plot(UK2,col =fCol$plot,add =TRUE,lwd =0.2)
# mapmisc::legendBreaks("left", fCol,bty ="n")
#
# # predicted
pdf("my_plot.pdf", width=324/300, height=432/300,)
mapmisc::map.new(UK2)
plot(UK2,col=pCol$plot,add =TRUE,lwd =0.2)
mapmisc::legendBreaks("left", pCol,bty ="n")
dev.off()
# casesCol=mapmisc::colourScale(UK2$cases,dec =-3,breaks =12,col ="Spectral",style="quantile",rev=TRUE)
# Ecol=mapmisc::colourScale(UK2$E,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
# pmCol=mapmisc::colourScale(UK2$modelledpm25,breaks =9,dec =0,style ="quantile")
# ethCol=mapmisc::colourScale(UK2$Ethnicity,breaks =9,digits =1,style ="quantile")
# uCol=mapmisc::colourScale(UK2$Unemployment,breaks =12,dec =0,style ="quantile")
# rCol=mapmisc::colourScale(englandRes$data$random.mean,breaks =12,dec =-log10(0.25),style ="quantile")
# fCol=mapmisc::colourScale(englandRes$data$fitted.exp,breaks =9,dec =1,style ="quantile")
# insetEngland1=mapmisc::openmap(UK2,zoom =3,fact =4,path ="waze",crs =CRS("+init=epsg:3035"))
# pCol=mapmisc::colourScale(UK2$E*englandRes$data$fitted.exp,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
#
# library("raster")
# insetEngland=raster::crop(insetEngland1,extend(extent(insetEngland1),-c(25,7,4,9.5)*100*1000))
# #
# # mapmisc::map.new(UK2)
# # mapmisc::insetMap(UK_shp,"topright", insetEngland,width =0.4)
# # plot(UK2,col =casesCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =Ecol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =pmCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", pmCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =ethCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", ethCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =uCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", uCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =rCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", rCol,bty ="n")
# mapmisc::map.new(UK2)
# plot(UK2,col =fCol$plot,add =TRUE,lwd =0.2)
# mapmisc::legendBreaks("left", fCol,bty ="n")
#
# # predicted
pdf("my_plot.pdf", width=324/300, height=432/300,)
mapmisc::map.new(UK2)
mapmisc::legendBreaks("left", pCol,bty ="n")
plot(UK2,col=pCol$plot,add =TRUE,lwd =0.2)
dev.off()
# casesCol=mapmisc::colourScale(UK2$cases,dec =-3,breaks =12,col ="Spectral",style="quantile",rev=TRUE)
# Ecol=mapmisc::colourScale(UK2$E,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
# pmCol=mapmisc::colourScale(UK2$modelledpm25,breaks =9,dec =0,style ="quantile")
# ethCol=mapmisc::colourScale(UK2$Ethnicity,breaks =9,digits =1,style ="quantile")
# uCol=mapmisc::colourScale(UK2$Unemployment,breaks =12,dec =0,style ="quantile")
# rCol=mapmisc::colourScale(englandRes$data$random.mean,breaks =12,dec =-log10(0.25),style ="quantile")
# fCol=mapmisc::colourScale(englandRes$data$fitted.exp,breaks =9,dec =1,style ="quantile")
# insetEngland1=mapmisc::openmap(UK2,zoom =3,fact =4,path ="waze",crs =CRS("+init=epsg:3035"))
# pCol=mapmisc::colourScale(UK2$E*englandRes$data$fitted.exp,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
#
# library("raster")
# insetEngland=raster::crop(insetEngland1,extend(extent(insetEngland1),-c(25,7,4,9.5)*100*1000))
# #
# # mapmisc::map.new(UK2)
# # mapmisc::insetMap(UK_shp,"topright", insetEngland,width =0.4)
# # plot(UK2,col =casesCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =Ecol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =pmCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", pmCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =ethCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", ethCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =uCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", uCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =rCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", rCol,bty ="n")
# mapmisc::map.new(UK2)
# plot(UK2,col =fCol$plot,add =TRUE,lwd =0.2)
# mapmisc::legendBreaks("left", fCol,bty ="n")
#
# # predicted
pdf("my_plot.pdf", width=324/300, height=432/300,)
mapmisc::map.new(UK2)
plot(UK2,col=pCol$plot,add =TRUE,lwd =0.2)
mapmisc::legendBreaks("left", pCol,bty ="n")
dev.off()
# casesCol=mapmisc::colourScale(UK2$cases,dec =-3,breaks =12,col ="Spectral",style="quantile",rev=TRUE)
# Ecol=mapmisc::colourScale(UK2$E,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
# pmCol=mapmisc::colourScale(UK2$modelledpm25,breaks =9,dec =0,style ="quantile")
# ethCol=mapmisc::colourScale(UK2$Ethnicity,breaks =9,digits =1,style ="quantile")
# uCol=mapmisc::colourScale(UK2$Unemployment,breaks =12,dec =0,style ="quantile")
# rCol=mapmisc::colourScale(englandRes$data$random.mean,breaks =12,dec =-log10(0.25),style ="quantile")
# fCol=mapmisc::colourScale(englandRes$data$fitted.exp,breaks =9,dec =1,style ="quantile")
# insetEngland1=mapmisc::openmap(UK2,zoom =3,fact =4,path ="waze",crs =CRS("+init=epsg:3035"))
pCol=mapmisc::colourScale(UK2$E*englandRes$data$fitted.exp,breaks =casesCol$breaks,col =casesCol$col,style="quantile")
casesCol=mapmisc::colourScale(UK2$cases,dec =-3,breaks =12,col ="Spectral",style="quantile",rev=TRUE)
Ecol=mapmisc::colourScale(UK2$E,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
pmCol=mapmisc::colourScale(UK2$modelledpm25,breaks =9,dec =0,style ="quantile")
ethCol=mapmisc::colourScale(UK2$Ethnicity,breaks =9,digits =1,style ="quantile")
uCol=mapmisc::colourScale(UK2$Unemployment,breaks =12,dec =0,style ="quantile")
rCol=mapmisc::colourScale(englandRes$data$random.mean,breaks =12,dec =-log10(0.25),style ="quantile")
fCol=mapmisc::colourScale(englandRes$data$fitted.exp,breaks =9,dec =1,style ="quantile")
insetEngland1=mapmisc::openmap(UK2,zoom =3,fact =4,path ="waze",crs =CRS("+init=epsg:3035"))
pCol=mapmisc::colourScale(UK2$E*englandRes$data$fitted.exp,breaks =casesCol$breaks,col =casesCol$col,style="quantile")
# casesCol=mapmisc::colourScale(UK2$cases,dec =-3,breaks =12,col ="Spectral",style="quantile",rev=TRUE)
# Ecol=mapmisc::colourScale(UK2$E,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
# pmCol=mapmisc::colourScale(UK2$modelledpm25,breaks =9,dec =0,style ="quantile")
# ethCol=mapmisc::colourScale(UK2$Ethnicity,breaks =9,digits =1,style ="quantile")
# uCol=mapmisc::colourScale(UK2$Unemployment,breaks =12,dec =0,style ="quantile")
# rCol=mapmisc::colourScale(englandRes$data$random.mean,breaks =12,dec =-log10(0.25),style ="quantile")
# fCol=mapmisc::colourScale(englandRes$data$fitted.exp,breaks =9,dec =1,style ="quantile")
# insetEngland1=mapmisc::openmap(UK2,zoom =3,fact =4,path ="waze",crs =CRS("+init=epsg:3035"))
pCol=mapmisc::colourScale(UK2$E*englandRes$data$fitted.exp,breaks =casesCol$breaks,col =casesCol$col,style="quantile", rev=TRUE)
# casesCol=mapmisc::colourScale(UK2$cases,dec =-3,breaks =12,col ="Spectral",style="quantile",rev=TRUE)
# Ecol=mapmisc::colourScale(UK2$E,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
# pmCol=mapmisc::colourScale(UK2$modelledpm25,breaks =9,dec =0,style ="quantile")
# ethCol=mapmisc::colourScale(UK2$Ethnicity,breaks =9,digits =1,style ="quantile")
# uCol=mapmisc::colourScale(UK2$Unemployment,breaks =12,dec =0,style ="quantile")
# rCol=mapmisc::colourScale(englandRes$data$random.mean,breaks =12,dec =-log10(0.25),style ="quantile")
# fCol=mapmisc::colourScale(englandRes$data$fitted.exp,breaks =9,dec =1,style ="quantile")
# insetEngland1=mapmisc::openmap(UK2,zoom =3,fact =4,path ="waze",crs =CRS("+init=epsg:3035"))
pCol=mapmisc::colourScale(UK2$E*englandRes$data$fitted.exp,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
#
# library("raster")
# insetEngland=raster::crop(insetEngland1,extend(extent(insetEngland1),-c(25,7,4,9.5)*100*1000))
# #
# # mapmisc::map.new(UK2)
# # mapmisc::insetMap(UK_shp,"topright", insetEngland,width =0.4)
# # plot(UK2,col =casesCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =Ecol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =pmCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", pmCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =ethCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", ethCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =uCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", uCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =rCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", rCol,bty ="n")
# mapmisc::map.new(UK2)
# plot(UK2,col =fCol$plot,add =TRUE,lwd =0.2)
# mapmisc::legendBreaks("left", fCol,bty ="n")
#
# # predicted
pdf("my_plot.pdf", width=324/300, height=432/300,)
mapmisc::map.new(UK2)
plot(UK2,col=pCol$plot,add =TRUE,lwd =0.2)
mapmisc::legendBreaks("left", pCol,bty ="n")
dev.off()
# casesCol=mapmisc::colourScale(UK2$cases,dec =-3,breaks =12,col ="Spectral",style="quantile",rev=TRUE)
# Ecol=mapmisc::colourScale(UK2$E,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
# pmCol=mapmisc::colourScale(UK2$modelledpm25,breaks =9,dec =0,style ="quantile")
# ethCol=mapmisc::colourScale(UK2$Ethnicity,breaks =9,digits =1,style ="quantile")
# uCol=mapmisc::colourScale(UK2$Unemployment,breaks =12,dec =0,style ="quantile")
# rCol=mapmisc::colourScale(englandRes$data$random.mean,breaks =12,dec =-log10(0.25),style ="quantile")
# fCol=mapmisc::colourScale(englandRes$data$fitted.exp,breaks =9,dec =1,style ="quantile")
# insetEngland1=mapmisc::openmap(UK2,zoom =3,fact =4,path ="waze",crs =CRS("+init=epsg:3035"))
pCol=mapmisc::colourScale(UK2$E*englandRes$data$fitted.exp,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
#
# library("raster")
# insetEngland=raster::crop(insetEngland1,extend(extent(insetEngland1),-c(25,7,4,9.5)*100*1000))
# #
# # mapmisc::map.new(UK2)
# # mapmisc::insetMap(UK_shp,"topright", insetEngland,width =0.4)
# # plot(UK2,col =casesCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =Ecol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =pmCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", pmCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =ethCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", ethCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =uCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", uCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =rCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", rCol,bty ="n")
# mapmisc::map.new(UK2)
# plot(UK2,col =fCol$plot,add =TRUE,lwd =0.2)
# mapmisc::legendBreaks("left", fCol,bty ="n")
#
# # predicted
pdf("my_plot.pdf", width=324/300, height=432/300,)
mapmisc::map.new(UK2)
plot(UK2,col=pCol$plot,add =TRUE,lwd =0.2)
mapmisc::legendBreaks("left", pCol,bty ="n", adj=0,)
dev.off()
# casesCol=mapmisc::colourScale(UK2$cases,dec =-3,breaks =12,col ="Spectral",style="quantile",rev=TRUE)
# Ecol=mapmisc::colourScale(UK2$E,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
# pmCol=mapmisc::colourScale(UK2$modelledpm25,breaks =9,dec =0,style ="quantile")
# ethCol=mapmisc::colourScale(UK2$Ethnicity,breaks =9,digits =1,style ="quantile")
# uCol=mapmisc::colourScale(UK2$Unemployment,breaks =12,dec =0,style ="quantile")
# rCol=mapmisc::colourScale(englandRes$data$random.mean,breaks =12,dec =-log10(0.25),style ="quantile")
# fCol=mapmisc::colourScale(englandRes$data$fitted.exp,breaks =9,dec =1,style ="quantile")
# insetEngland1=mapmisc::openmap(UK2,zoom =3,fact =4,path ="waze",crs =CRS("+init=epsg:3035"))
pCol=mapmisc::colourScale(UK2$E*englandRes$data$fitted.exp,breaks =casesCol$breaks,col =casesCol$col,style="fixed")
#
# library("raster")
# insetEngland=raster::crop(insetEngland1,extend(extent(insetEngland1),-c(25,7,4,9.5)*100*1000))
# #
# # mapmisc::map.new(UK2)
# # mapmisc::insetMap(UK_shp,"topright", insetEngland,width =0.4)
# # plot(UK2,col =casesCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =Ecol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", casesCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =pmCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", pmCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =ethCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", ethCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =uCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", uCol,bty ="n")
# # mapmisc::map.new(UK2)
# # plot(UK2,col =rCol$plot,add =TRUE,lwd =0.2)
# # mapmisc::legendBreaks("left", rCol,bty ="n")
# mapmisc::map.new(UK2)
# plot(UK2,col =fCol$plot,add =TRUE,lwd =0.2)
# mapmisc::legendBreaks("left", fCol,bty ="n")
#
# # predicted
pdf("my_plot.pdf", width=324/300, height=432/300,)
mapmisc::map.new(UK2)
plot(UK2,col=pCol$plot,add =TRUE,lwd =0.2)
mapmisc::legendBreaks("left", pCol,bty ="n",cex=par('cex'), pt.cex=0.1*cex,)
View(insetEngland1)
table2 <- rbind(round(exp(englandRes$parameters$summary[,c(1,3,5)]), 3))
knitr::kable(table2,
digits =5,
booktabs = TRUE,
caption = "Effects posterior medians and 95% credible intervals in relative rate")
table2 <- rbind(round(exp(englandRes$parameters$summary[,c(4,3,5)]), 3))
knitr::kable(table2,
digits =5,
booktabs = TRUE,
caption = "Effects posterior medians and 95% credible intervals in relative rate")
1.012*exp(10)
1.012*exp(5)
0.08105 * log(2)
exp(0.08105 * log(2))
0.01204645
0.01204645*10
exp(0.01204645*10)
View(table2)
load("./data/Wisconsin.RData")
# resTrump=diseasemapping::bym(trump~logPdens+propWhite+propInd,
#                              data=wisconsinCsubm,
#                              prior =list(
#                                sd =c(log(2.5),0.5),propSpatial =c(0.5,0.5)),
#                              Ntrials =wisconsinCsubm$Total,
#                              family ="binomial")
# save(resTrump,file ="./data/resWisconsin.RData",compress ="xz")
(load("./data/resWisconsin.RData"))
table1 <- (resTrump$parameters$summary[,paste0(c(0.5,0.025,0.975),"quant")])
table1[-1,] <- exp(table1[-1, ])
table1 <- rbind(round(table1, 3))
knitr::kable(table1,
digits =5,
booktabs = TRUE,
caption = "Effects posterior median and 95% credible intervals in odds ratio")
table1 <- (resTrump$parameters$summary[,paste0(c(0.5,0.025,0.975),"quant")])
table1[-1,] <- exp(table1[-1, ])
table1 <- rbind(round(table1, 3))
knitr::kable(table1,
digits =5,
booktabs = TRUE,
caption = "Effects posterior median and 95% credible intervals in odds ratio")
table1 <- (resTrump$parameters$summary[,paste0(c(0.5,0.025,0.975),"quant")])
table1[-1,] <- exp(table1[-1, ])
table1 <- rbind(round(table1, 3))
knitr::kable(table1,
digits =5,
booktabs = TRUE,
caption = "Effects posterior median and 95% credible intervals in odds ratio")
table1 <- (resTrump$parameters$summary[,paste0(c(0.5,0.025,0.975),"quant")])
knitr::kable(table1,
digits =5,
booktabs = TRUE,
caption = "Effects posterior median and 95% credible intervals in odds ratio")
table1[-1, ]
table1 <- (resTrump$parameters$summary[,paste0(c(0.5,0.025,0.975),"quant")])
table1[-6,] <- exp(table1[-6, ])
table1 <- rbind(round(table1, 3))
knitr::kable(table1,
digits =5,
booktabs = TRUE,
caption = "Effects posterior median and 95% credible intervals in odds ratio")
table2 <- englandRes$parameters$summary[,c(4,3,5)]
table2[-6,] <- exp(table1[-6, ])
table2 <- rbind(round(table1, 3))
knitr::kable(table2,
digits =5,
booktabs = TRUE,
caption = "Fixed effects, random effects in relative risk, and spatial proportion")
